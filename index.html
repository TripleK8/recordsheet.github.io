<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Individual Record Sheet</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load SheetJS library for Excel file reading -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Import Sarabun font (Google Fonts) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Base styles using Sarabun exclusively */
        html, body {
            height: 100%; 
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f3f4f6;
            -webkit-font-smoothing: antialiased;
            color: #1f2937;
            
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding-top: 20px;
            padding-bottom: 20px;
        }
        
        .a4-page {
            width: 210mm;
            min-height: 297mm;
            background: white;
            margin: 0 auto; 
            padding: 15mm; 
            box-shadow: 0 0 15px rgba(0,0,0,0.15);
            position: relative;
            box-sizing: border-box;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
        }

        /* Class สำหรับกรอบข้อมูล (เฉพาะบนหน้าจอ) */
        .page-frame {
            border: 2px solid #000;
            padding: 20px;
            width: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            position: relative;
        }

        /* Input field styling */
        .input-line {
            border: none;
            border-bottom: 1px solid #9ca3af;
            width: 100%;
            outline: none;
            padding: 2px 0;
            font-weight: 500;
            color: #000;
            background: transparent;
            font-size: 14px;
            text-align: center;
            transition: border-bottom-color 0.2s;
        }
        .input-line:focus {
            border-bottom: 2px solid #2563eb;
        }

        .input-date {
            font-family: inherit;
            border: none;
            border-bottom: 1px solid #9ca3af;
            outline: none;
            padding: 2px 0;
            padding-left: 5px;
            font-weight: 500;
            color: #000;
            background: transparent;
            font-size: 14px;
            text-align: left;
            appearance: none;
        }

        /* ตารางบนหน้าจอ: ขอบมน */
        table {
            width: 100%;
            margin-bottom: 1.2rem;
            table-layout: fixed;
            border-collapse: separate; 
            border-spacing: 0;
            border: 1px solid #000;
            border-radius: 12px;
            overflow: hidden;
            background-clip: padding-box;
        }
        
        th, td {
            padding: 6px 4px;
            vertical-align: middle;
            font-size: 13px;
            border-right: 1px solid #000;
            border-bottom: 1px solid #000;
            border-left: none;
            border-top: none;
        }
        
        th:last-child, td:last-child { border-right: none; }
        tbody tr:last-child td { border-bottom: none; }

        td { text-align: center; }
        .label-table td:first-child { text-align: left !important; padding-left: 12px; }
        th { background-color: #e5e7eb; font-weight: bold; color: #000; text-align: center !important; }
        
        /* Custom Checkbox Appearance */
        .checkbox-group { display: inline-flex; gap: 8px; align-items: center; cursor: pointer; font-size: 14px; }
        .checkbox-box {
            width: 16px; height: 16px; border: 1px solid #000; display: inline-block;
            vertical-align: middle; margin-right: 4px; background-color: white; position: relative;
        }
        .checkbox-box.checked::after {
            content: '✓'; position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); font-size: 12px; color: #000;
        }

        .delete-page-btn { position: absolute; top: 5mm; left: 5mm; z-index: 20; padding: 6px 10px; cursor: pointer; }

        /* --- Print Media Query: Optimized for PDF Fidelity --- */
        @media print {
            @page { size: A4 portrait; margin: 0; }
            body { background: white; margin: 0; font-size: 14px !important; display: block; padding: 0 !important; }
            
            .a4-page {
                box-shadow: none; margin: 0; page-break-after: always;
                width: 210mm !important; min-height: 297mm !important;
                padding: 10mm 15mm !important; border-radius: 0;
            }

            .page-frame { border: none !important; padding: 0 !important; }

            /* แก้ปัญหาเส้นตารางหาย: บังคับใช้ collapse และวาดเส้นใหม่ทุกด้าน */
            table {
                border-collapse: collapse !important;
                border: 1px solid #000 !important;
                border-radius: 0 !important;
                overflow: visible !important;
                margin-bottom: 1rem !important;
            }
            
            th, td {
                border: 1px solid #000 !important; /* บังคับเส้นขอบดำสนิท */
                padding: 4px 2px !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .no-print, .delete-page-btn, #custom-modal-overlay { display: none !important; }
            
            .text-2xl { font-size: 16pt !important; }
            .text-lg { font-size: 11pt !important; }
            .text-base { font-size: 10pt !important; }
            
            .input-line, .input-date, select {
                border-bottom: 1px solid #000 !important;
                font-size: 10pt !important;
            }
        }
    </style>
    <script>
        const THAI_MONTHS_SHORT = ["ม.ค.", "ก.พ.", "มี.ค.", "เม.ย.", "พ.ค.", "มิ.ย.", "ก.ค.", "ส.ค.", "ก.ย.", "ต.ค.", "พ.ย.", "ธ.ค."];

        function formatDateToThai(isoDateString) {
            if (!isoDateString) return '';
            try {
                const date = new Date(isoDateString);
                if (isNaN(date.getTime())) return ''; 
                return `${date.getDate()} ${THAI_MONTHS_SHORT[date.getMonth()]} ${date.getFullYear() + 543}`;
            } catch (e) { return ''; }
        }

        // --- Custom Alert/Confirm ---
        function showCustomAlert(message) {
            const modal = document.getElementById('custom-modal');
            document.getElementById('modal-message').innerHTML = message.replace(/\n/g, '<br>');
            document.getElementById('modal-confirm-btn').onclick = () => {
                document.getElementById('custom-modal').classList.add('hidden');
                document.getElementById('custom-modal-overlay').classList.add('hidden');
            };
            document.getElementById('modal-cancel-btn').classList.add('hidden');
            modal.classList.remove('hidden');
            document.getElementById('custom-modal-overlay').classList.remove('hidden');
        }

        function showCustomConfirm(message, callback) {
            const modal = document.getElementById('custom-modal');
            document.getElementById('modal-message').innerHTML = message.replace(/\n/g, '<br>');
            const confirmBtn = document.getElementById('modal-confirm-btn');
            const cancelBtn = document.getElementById('modal-cancel-btn');
            
            cancelBtn.classList.remove('hidden');
            confirmBtn.onclick = () => { hideModal(); callback(true); };
            cancelBtn.onclick = () => { hideModal(); callback(false); };

            function hideModal() {
                modal.classList.add('hidden');
                document.getElementById('custom-modal-overlay').classList.add('hidden');
            }
            modal.classList.remove('hidden');
            document.getElementById('custom-modal-overlay').classList.remove('hidden');
        }

        // --- Radio Logic (Supports Uncheck) ---
        function toggleRadio(labelElement, event) {
            if (event) { event.preventDefault(); event.stopPropagation(); }
            const inputRadio = labelElement.querySelector('input[type="radio"]');
            const parentControl = labelElement.closest('.checkbox-control');
            const currentBox = labelElement.querySelector('.checkbox-box');
            if (!inputRadio) return;

            const isAlreadyChecked = currentBox.classList.contains('checked');

            parentControl.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.checked = false;
                radio.closest('.checkbox-option').querySelector('.checkbox-box').classList.remove('checked');
            });

            if (!isAlreadyChecked) {
                inputRadio.checked = true;
                currentBox.classList.add('checked');
            }
        }

        function syncDateCheckboxes(sourceCheckbox) {
            const isChecked = sourceCheckbox.checked;
            document.querySelectorAll('.sync-date-checkbox').forEach(cb => cb.checked = isChecked);
            if (isChecked) {
                const dateVal = sourceCheckbox.closest('.a4-page').querySelector('.testDateHidden').value;
                if (dateVal) {
                    document.querySelectorAll('.testDateHidden').forEach(input => {
                        input.value = dateVal;
                        input.closest('.date-control').querySelector('.testDateDisplay').value = formatDateToThai(dateVal);
                    });
                }
            }
        }

        function handleDateChange(hiddenInput) {
            const iso = hiddenInput.value;
            hiddenInput.closest('.date-control').querySelector('.testDateDisplay').value = formatDateToThai(iso);
            const sync = hiddenInput.closest('.a4-page').querySelector('.sync-date-checkbox');
            if (sync && sync.checked) {
                document.querySelectorAll('.testDateHidden').forEach(input => {
                    input.value = iso;
                    input.closest('.date-control').querySelector('.testDateDisplay').value = formatDateToThai(iso);
                });
            }
        }

        function syncCenterSelection(val) {
            document.querySelectorAll('.trainingCenterSelect').forEach(s => s.value = val);
        }

        function updatePageNumbering() {
            document.querySelectorAll('.a4-page').forEach((page, i) => {
                const num = (i + 1).toString().padStart(3, '0');
                
                // Only auto-fill if empty to allow Excel overwrite, OR always overwrite if we treat Excel as source of truth.
                // However, since we import Excel data *after* creating pages, we can let processExcelData overwrite these.
                // But for manual add page, we want auto numbering.
                
                const seq = page.querySelector('.sequence-number-input');
                const res = page.querySelector('.research-id-input');
                
                // Basic auto-numbering (will be overwritten by Excel import if data exists)
                if (seq && !seq.value) seq.value = num;
                if (res && !res.value) res.value = `ช${num}`;
                
                page.querySelectorAll('input[name^="gender"]').forEach(r => r.name = `gender_${i}`);
                page.querySelectorAll('input[name^="dominantHand"]').forEach(r => r.name = `hand_${i}`);
            });
        }

        function setTotalPages(target) {
            let pages = document.querySelectorAll('.a4-page');
            const current = pages.length;
            if (target === current) return;
            const container = document.querySelector('.page-container');

            if (target < current) {
                for (let i = current - 1; i >= target; i--) pages[i].remove();
            } else {
                const template = pages[0];
                for (let i = current; i < target; i++) {
                    const clone = template.cloneNode(true);
                    // Reset inputs
                    clone.querySelectorAll('input:not([type="checkbox"]), select').forEach(input => {
                        if (!input.classList.contains('trainingCenterSelect')) input.value = '';
                    });
                    clone.querySelectorAll('.checkbox-box').forEach(box => box.classList.remove('checked'));
                    clone.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
                    container.appendChild(clone);
                }
            }
            updatePageNumbering();
            document.getElementById('pageCountInput').value = document.querySelectorAll('.a4-page').length;
        }

        function applyPageCount() {
            const val = parseInt(document.getElementById('pageCountInput').value);
            if (val > 0) setTotalPages(val);
        }

        function deletePage(btn) {
            if (document.querySelectorAll('.a4-page').length > 1) {
                showCustomConfirm("ยืนยันการลบหน้านี้หรือไม่?", (ok) => {
                    if (ok) { btn.closest('.a4-page').remove(); updatePageNumbering(); }
                });
            } else {
                showCustomAlert("ไม่สามารถลบหน้าสุดท้ายได้");
            }
        }

        function setAllGender(val) {
            document.querySelectorAll('.a4-page').forEach(page => {
                const radio = page.querySelector(`input[value="${val}"][name^="gender"]`);
                if (radio) toggleRadio(radio.closest('.checkbox-option'));
            });
        }

        // === EXCEL IMPORT LOGIC (UPDATED) ===
        function handleFile(event) {
            const file = event.target.files[0];
            if (!file) return;
            if (!file.name.endsWith('.xlsx') && !file.name.endsWith('.xls')) {
                showCustomAlert('กรุณาเลือกไฟล์ Excel (.xlsx หรือ .xls) เท่านั้น');
                event.target.value = '';
                return;
            }
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                    const json = XLSX.utils.sheet_to_json(worksheet, { header: 1 }); 
                    const dataRows = json.slice(1); 
                    processExcelData(dataRows);
                } catch (error) {
                    console.error(error);
                    showCustomAlert(`เกิดข้อผิดพลาด: ${error.message}`);
                }
                event.target.value = '';
            };
            reader.readAsArrayBuffer(file);
        }

        function processExcelData(data) {
            if (data.length === 0) {
                showCustomAlert('ไม่พบข้อมูลในไฟล์ Excel');
                return;
            }

            const requiredPages = data.length;
            setTotalPages(requiredPages); 
            const allPages = document.querySelectorAll('.a4-page');
            
            data.forEach((row, index) => {
                const page = allPages[index];
                if (!page) return;
                
                const getValue = (colIndex) => (row[colIndex] !== undefined && row[colIndex] !== null) ? String(row[colIndex]).trim() : '';
                const getInput = (selector) => page.querySelector(selector);

                // --- 1. Sequence Number (Col A -> Index 0) ---
                const seqVal = getValue(0);
                const seqInput = getInput('.sequence-number-input');
                if (seqInput) seqInput.value = seqVal;

                // --- 2. Fullname (Col B -> Index 1) ---
                const nameInput = getInput('[data-field="fullname"]');
                if (nameInput) nameInput.value = getValue(1);

                // --- 3. Nickname (Col C -> Index 2) ---
                const nickInput = getInput('[data-field="nickname"]');
                if (nickInput) nickInput.value = getValue(2);

                // --- 4. Age (Col D -> Index 3) ---
                const ageInput = getInput('[data-field="age"]');
                if (ageInput) ageInput.value = getValue(3).replace(/[^0-9.]/g, '');

                // --- 5. Research ID (Col E -> Index 4) ---
                const resInput = getInput('.research-id-input');
                if (resInput) resInput.value = getValue(4);

                // --- 6. Gender (Col G -> Index 6) ---
                const genderVal = getValue(6).toLowerCase();
                let genderRadio = null;
                
                // Identify target radio
                if (genderVal.includes('ชาย') || genderVal === 'male' || genderVal === 'm') {
                    genderRadio = page.querySelector('input[name^="gender"][value="male"]');
                } else if (genderVal.includes('หญิง') || genderVal === 'female' || genderVal === 'f') {
                    genderRadio = page.querySelector('input[name^="gender"][value="female"]');
                }

                // Apply check if found
                if (genderRadio) {
                    const parentControl = genderRadio.closest('.checkbox-control');
                    // Reset group first
                    parentControl.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
                    parentControl.querySelectorAll('.checkbox-box').forEach(b => b.classList.remove('checked'));
                    
                    // Check target
                    genderRadio.checked = true;
                    const box = genderRadio.closest('.checkbox-option').querySelector('.checkbox-box');
                    if (box) box.classList.add('checked');
                }
            });

            showCustomAlert(`นำเข้าข้อมูลสำเร็จ: ${data.length} รายการ`);
        }

        window.onload = () => { setTotalPages(1); };
    </script>
</head>
<body>

    <!-- Custom Modal -->
    <div id="custom-modal-overlay" class="fixed inset-0 bg-gray-900 bg-opacity-70 z-[100] hidden"></div>
    <div id="custom-modal" class="fixed inset-0 flex items-center justify-center z-[101] hidden">
        <div class="bg-white p-6 rounded-lg shadow-2xl w-full max-w-sm mx-4">
            <div class="text-lg font-semibold mb-4 text-gray-900">แจ้งเตือน</div>
            <p id="modal-message" class="text-gray-700 mb-6"></p>
            <div class="flex justify-end gap-3">
                <button id="modal-cancel-btn" class="bg-gray-300 hover:bg-gray-400 py-2 px-4 rounded-md">ยกเลิก</button>
                <button id="modal-confirm-btn" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md">ตกลง</button>
            </div>
        </div>
    </div>

    <!-- Controls -->
    <div class="fixed top-4 right-4 no-print z-50 flex flex-col items-end gap-3">
        <!-- Import Data Controls -->
        <div class="bg-white p-2 rounded-lg shadow-xl border border-gray-300 flex flex-col gap-2">
            <h4 class="text-xs font-bold text-gray-500 text-center uppercase tracking-wider">ควบคุมข้อมูล</h4>
            <div class="flex gap-2">
                <input type="file" id="excelFileInput" accept=".xlsx,.xls" class="hidden" onchange="handleFile(event)">
                <button onclick="document.getElementById('excelFileInput').click()" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-1 px-3 rounded-md shadow transition text-sm flex items-center gap-1 flex-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="10" y1="15" x2="18" y2="15"></line><line x1="10" y1="19" x2="18" y2="19"></line><line x1="6" y1="11" x2="18" y2="11"></line></svg>
                    นำเข้า (Excel)
                </button>
                <!-- Clear Imported Data Button -->
                <button onclick="clearImportedData()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-1 px-3 rounded-md shadow transition text-sm flex items-center gap-1 flex-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"></path><line x1="18" y1="9" x2="12" y2="15"></line><line x1="12" y1="9" x2="18" y2="15"></line></svg>
                    ล้างข้อมูลนำเข้า
                </button>
            </div>
        </div>

        <div class="bg-white p-2 rounded-lg shadow-xl border border-gray-300 flex flex-col gap-2 w-full">
            <h4 class="text-xs font-bold text-gray-500 text-center uppercase">เลือกเพศ (ทั้งหมด)</h4>
            <div class="flex gap-2">
                 <button onclick="setAllGender('male')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-3 rounded-md text-sm flex-1">ชาย</button>
                 <button onclick="setAllGender('female')" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-1 px-3 rounded-md text-sm flex-1">หญิง</button>
            </div>
        </div>
        <div class="bg-white p-2 rounded-lg shadow-xl border border-gray-300 flex items-center gap-2">
            <label class="text-sm font-semibold">จำนวนหน้า:</label>
            <input type="number" id="pageCountInput" value="1" min="1" class="w-12 text-center border rounded-md">
            <button onclick="applyPageCount()" class="bg-green-600 text-white font-bold py-1 px-3 rounded-md text-sm">ปรับใช้</button>
        </div>
        <button onclick="window.print()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-xl flex items-center gap-2 transition">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>
            พิมพ์เอกสาร (PDF)
        </button>
    </div>

    <div class="page-container">
        <div class="a4-page flex flex-col">
            <button onclick="deletePage(this)" class="bg-red-600 text-white font-bold py-1 px-3 rounded-md delete-page-btn no-print">ลบหน้า</button>

            <div class="page-frame">
                <div>
                    <div class="text-center mb-4">
                        <h1 class="text-2xl font-bold uppercase tracking-wider mb-1 text-gray-900">แบบบันทึกข้อมูลการทดสอบสมรรถภาพ</h1>
                        <h2 class="text-lg text-gray-600 font-light">(Data Collection Record Sheet)</h2>
                    </div>

                    <div class="mb-4 flex items-end justify-center px-4 header-info">
                        <span class="font-bold text-base mr-2 whitespace-nowrap">ศูนย์ฝึกและอบรมเด็กและเยาวชน:</span>
                        <select class="input-line flex-1 trainingCenterSelect" onchange="syncCenterSelection(this.value)">
                            <option value="" disabled selected>--- เลือกศูนย์ฯ ---</option>
                            <option value="ระยอง">ระยอง</option>
                            <option value="ราชบุรี">ราชบุรี</option>
                            <option value="บ้านชายกรุณา">ชายบ้านกรุณา</option>
                            <option value="เชียงใหม่">เชียงใหม่</option>
                            <option value="สุราษฎร์ธานี">สุราษฎร์ธานี</option>
                            <option value="อุบลราชธานี">อุบลราชธานี</option>
                        </select>
                    </div>

                    <div class="mb-6 flex items-end justify-end px-4 date-control">
                        <label class="flex items-center mr-4 cursor-pointer no-print">
                            <input type="checkbox" class="w-3 h-3 mr-2 sync-date-checkbox" onchange="syncDateCheckboxes(this)">
                            <span class="text-xs font-semibold text-gray-700">ใช้วันที่เดียวกันทุกหน้า</span>
                        </label>
                        <span class="font-bold text-base mr-4">วันที่ทดสอบ:</span>
                        <div class="relative w-36">
                            <input type="text" class="input-date w-full pr-8 testDateDisplay" placeholder="วัน/เดือน/ปี" readonly>
                            <input type="date" class="absolute inset-0 w-full opacity-0 cursor-pointer testDateHidden" onchange="handleDateChange(this)">
                        </div>
                    </div>

                    <!-- Section 1 -->
                    <div class="mb-6 border border-black p-4 rounded-md">
                        <h3 class="font-bold text-lg mb-3">1. ข้อมูลทั่วไป (General Information)</h3>
                        <div class="grid grid-cols-2 gap-4 mb-3">
                            <div class="flex items-end"><span class="font-semibold w-20 text-sm">ลำดับที่:</span><input type="text" class="input-line sequence-number-input" readonly></div>
                            <div class="flex items-end"><span class="font-semibold w-20 text-sm">รหัสวิจัย:</span><input type="text" class="input-line research-id-input" readonly></div>
                        </div>
                        <div class="grid grid-cols-2 gap-4 mb-3">
                            <div class="flex items-end"><span class="font-semibold w-20 text-sm">ชื่อจริง:</span><input type="text" class="input-line" data-field="fullname"></div>
                            <div class="flex items-end"><span class="font-semibold w-20 text-sm">ชื่อเล่น:</span><input type="text" class="input-line" data-field="nickname"></div>
                        </div>
                        <div class="grid grid-cols-3 gap-4 mt-4">
                            <div class="flex items-center checkbox-control">
                                <span class="font-semibold mr-2 text-sm">เพศ:</span>
                                <label class="checkbox-option mr-2 checkbox-group" onclick="toggleRadio(this, event)">
                                    <input type="radio" name="gender" value="male" class="hidden"><span class="checkbox-box"></span> ชาย
                                </label>
                                <label class="checkbox-option checkbox-group" onclick="toggleRadio(this, event)">
                                    <input type="radio" name="gender" value="female" class="hidden"><span class="checkbox-box"></span> หญิง
                                </label>
                            </div>
                            <div class="flex items-end"><span class="font-semibold mr-1 text-sm">ส่วนสูง:</span><input type="number" class="input-line w-12" data-field="height"><span class="text-xs ml-1">ซม.</span></div>
                            <div class="flex items-end"><span class="font-semibold mr-1 text-sm">น้ำหนัก:</span><input type="number" class="input-line w-12"><span class="text-xs ml-1">กก.</span></div>
                        </div>
                    </div>

                    <!-- Section 2 -->
                    <div class="mb-6">
                        <h3 class="font-bold text-lg mb-2">2. สัดส่วนร่างกาย (Body Composition)</h3>
                        <table class="label-table">
                            <thead>
                                <tr><th class="w-1/2">รายการ</th><th class="w-1/4">Trial 1 (cm)</th><th class="w-1/4">Trial 2 (cm)</th></tr>
                            </thead>
                            <tbody>
                                <tr><td class="font-semibold py-2">เส้นรอบเอว (Waist)</td><td><input type="text" class="w-full bg-transparent"></td><td><input type="text" class="w-full bg-transparent"></td></tr>
                                <tr><td class="font-semibold py-2">เส้นรอบสะโพก (Hip)</td><td><input type="text" class="w-full bg-transparent"></td><td><input type="text" class="w-full bg-transparent"></td></tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Section 3 -->
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="font-bold text-lg">3. Handgrip Strength Test</h3>
                            <div class="flex items-center checkbox-control">
                                <span class="font-semibold mr-2 text-sm">ข้างที่ถนัด:</span>
                                <label class="checkbox-option mr-2 checkbox-group" onclick="toggleRadio(this, event)">
                                    <input type="radio" name="dominantHand" value="right" class="hidden"><span class="checkbox-box"></span> ขวา
                                </label>
                                <label class="checkbox-option checkbox-group" onclick="toggleRadio(this, event)">
                                    <input type="radio" name="dominantHand" value="left" class="hidden"><span class="checkbox-box"></span> ซ้าย
                                </label>
                            </div>
                        </div>
                        <table class="label-table">
                            <thead>
                                <tr><th class="w-1/4">ข้าง (Side)</th><th class="w-1/4">Trial 1 (kg)</th><th class="w-1/4">Trial 2 (kg)</th><th class="w-1/4">Trial 3 (kg)</th></tr>
                            </thead>
                            <tbody>
                                <tr><td class="font-semibold py-3">ข้างถนัด (Dominant)</td><td><input type="text" class="w-full bg-transparent"></td><td><input type="text" class="w-full bg-transparent"></td><td><input type="text" class="w-full bg-transparent"></td></tr>
                                <tr><td class="font-semibold py-3">ไม่ถนัด (Non-Dom)</td><td><input type="text" class="w-full bg-transparent"></td><td><input type="text" class="w-full bg-transparent"></td><td><input type="text" class="w-full bg-transparent"></td></tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Section 4 -->
                    <div class="mb-6">
                        <h3 class="font-bold text-lg mb-2">4. Back-Leg Dynamometer Test</h3>
                        <table>
                            <thead>
                                <tr><th class="w-1/3">Trial 1 (kg)</th><th class="w-1/3">Trial 2 (kg)</th><th class="w-1/3">Trial 3 (kg)</th></tr>
                            </thead>
                            <tbody>
                                <tr class="h-12"><td><input type="text" class="w-full bg-transparent font-bold"></td><td><input type="text" class="w-full bg-transparent font-bold"></td><td><input type="text" class="w-full bg-transparent font-bold"></td></tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Section 5 -->
                    <div>
                        <h3 class="font-bold text-lg mb-2">5. ความทนทานหัวใจและเหนื่อย (20M-SRT)</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="border border-black rounded-lg overflow-hidden">
                                <div class="bg-gray-200 p-1 text-center font-bold text-xs">จำนวนรอบสะสม</div>
                                <div class="p-4 flex justify-center items-end gap-2">
                                    <input type="number" class="border border-gray-400 w-16 h-10 text-center rounded text-lg font-bold">
                                    <span class="text-sm">รอบ</span>
                                </div>
                            </div>
                            <div class="border border-black rounded-lg overflow-hidden">
                                <div class="bg-gray-200 p-1 text-center font-bold text-xs">ระดับความเหนื่อย (CR10)</div>
                                <div class="p-3 grid grid-cols-2 gap-2">
                                    <div class="text-center"><span class="text-[10px] block">Cardio</span><input type="number" class="border border-gray-300 w-10 text-center"></div>
                                    <div class="text-center"><span class="text-[10px] block">Muscle</span><input type="number" class="border border-gray-300 w-10 text-center"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
